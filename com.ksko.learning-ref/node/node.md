node.js 간단 정리 (주니어 자바 웹개발자가 보고 비교하는)
====

node로 토이프로젝트를 하면서(잠깐 쉬고있긴 하지만..) 잠깐 정리를 해볼까한다. 원래 자바 웹 개발자로서 node의 방식은 아주 새롭고 다르고 혼란스러운 개념 투성이었다. 물론 지금도 그렇다.  
처음에 함수가 이상태인데도 동작이 된단말이야?? 하는 부분이 쇼킹했었는데, 그건 나중에 한번 더 정리해보도록 하고 지금은 간단하게 요약을 해볼까한다. 토이프로젝트에는 node.js의 express라는 프레임워크를 쓰고있다. yarn을 이용하고있는데 yarn은 무엇일까?

#yarn
패키지 매니저 관리자이다. npm이라는 존재와 헷갈렸었는데, 스프링으로 치면 maven과 gradle이라고 생각하면 되겠다. gradle이 그루비 언어로 가독성 좋게 표현이 되고..뭐 그러긴 하지만 여튼 내부 레파지토리는 메이븐 것을 쓴다. yarn도 마찬가지인데, 라이브러리는 전부 npm에 있다. npm은 노드 패키지 매니저로 원래는 커뮤니티였다가 노드를 쉽게 사용할 수 있도록 명령어를 제공하기 시작했다. 그러나 보안이슈, 빌드성능 저하 같은 문제로 yarn을 많이들 쓰기 시작했다. yarn으로 npm에 있는 라이브러리들을 install한다.

#노드
노드는 이벤트 기반의 논블로킹I/O 언어이다. 논블로킹 언어가 뭐지? 한다면, 자바는 블로킹언어이다.. 보다는 였다. 블로킹은 알다시피 요청을 하면 처리할 때까지 응답을 주지 않는다. 멀티쓰레드 언어이기 때문에 보완은 되긴 했겠지만 요청이 오래 걸리는 것이라면 성능문제는 이슈가 된다. 그래서 나온것이 NIO이다. 논블로킹 I/O를 제공하게 된것이다.   
노드는 비동기 함수를 어떻게 관리할까?

#노드 동작방식
일단 실행 함수들을 만나면 호출 스택에 쌓는다. 이것도 싱글쓰레드이기 떄문이다. 자바는 요청이 들어오면 쓰레드를 만들든 있던걸 재활용하든 쓰레드를 하나 더 쓰면 되는 일이다.  
호출 스택에 쌓았는데 이 실행함수가 비동기이다? 그러면 바로 백그라운드로 보낸다. 그렇게 들어온 비동기들을 백그라운드로 보내고 실행하고, 태스크큐에 올라간다. 동기 함수들은 차례로 실행이 된다. 그러다 호출 스택이 비면 호출스택으로 다시 올라온다.   
호출 스택이 비지 않으면 어떡하지? 그러면 호출 스택 내부 설정이든 사용자 지정 설정이든 일정 시간이 지나면 exception을 던진다. 그리고 그렇게 애초에 많은 시간이 걸리는 일은 노드로 구현하는 것으로 적합하지 않다.


